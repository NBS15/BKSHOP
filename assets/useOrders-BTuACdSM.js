import{a as l,c as s,v as m}from"./index-FscBDe09.js";function S(){const{user:r}=l(),{orders:d,notifications:n,addOrderToStore:a,removeOrderFromStore:p}=s();return{orders:d,notifications:n,addOrder:async e=>{let t=null;const o="https://bkshop-production.up.railway.app";try{t=(await(await fetch(`${o}/api/orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r?.uid,items:[{productId:e.product.id,name:e.product.name,quantity:1,price:e.product.price,size:e.taille,color:e.couleur}],totalAmount:e.product.price,shipping:{firstName:e.firstName,lastName:e.lastName,address:e.address,phone:e.phone}})})).json())?.id??null}catch(i){console.error("create failed",i)}const c={id:t||m(),product:e.product,taille:e.taille,couleur:e.couleur,firstName:e.firstName,lastName:e.lastName,address:e.address,phone:e.phone,status:"en_attente",createdAt:new Date};a(c);const u=s.getState().orders;return r?.uid&&localStorage.setItem(`orders:${r.uid}`,JSON.stringify(u)),c},cancelOrder:async e=>{p(e);const t=s.getState().orders;r?.uid&&localStorage.setItem(`orders:${r.uid}`,JSON.stringify(t));try{await fetch(`https://bkshop-production.up.railway.app/api/orders/${e}`,{method:"DELETE"})}catch(o){console.error("delete failed",o)}}}}export{S as u};
